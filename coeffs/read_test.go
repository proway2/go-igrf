package coeffs

import (
	"math"
	"testing"
)

func TestIGRFcoeffs_Coeffs(t *testing.T) {
	igrf, _ := NewCoeffsData()
	type args struct {
		date float64
	}
	tests := []struct {
		name    string
		args    args
		want1   *[]float64
		want2   *[]float64
		want3   int
		wantErr bool
	}{
		{
			name:    "1920.5: Coeffs when degrees are equal (10), but coeffs are not definitive",
			args:    args{date: 1920.5},
			want1:   &[]float64{-31046.599999999999, -2317.0999999999999, 5842.1999999999998, -844.39999999999998, 2960, -1266.5, 1413.4000000000001, 813.5, 1113.9000000000001, -1604.5, -446.69999999999999, 1204.7, 104.59999999999999, 843.20000000000005, 286.60000000000002, 889.20000000000005, 696.60000000000002, 219.59999999999999, 614.5, -136.90000000000001, -424.19999999999999, -150.69999999999999, 200.80000000000001, -58.299999999999997, -221.90000000000001, 326, -119.40000000000001, 235, 58, -23.5, -38.600000000000001, -119.59999999999999, -124.7, -62.700000000000003, 43.799999999999997, 61, 54.899999999999999, 0.30000000000000004, -9.9000000000000004, 96.299999999999997, -233.5, 11.300000000000001, -45.399999999999999, -21.600000000000001, 43.5, 17.5, -101.2, -56.5, 73, -54, -49.100000000000001, 2.1000000000000001, -14, 28.800000000000001, -13.1, -36.799999999999997, 4.0999999999999996, -15.800000000000001, 28.100000000000001, 19, -16.100000000000001, 6, -21.899999999999999, 11, 7, 8, -3, -15, -9, 6, 2, -14, 4, 5, -7, 17, 6.0999999999999996, -5, 8, -19, 8, 10, -20, 1, 14, -11, 5, 12, -3, 1, -2, -2, 9, 2, 10, 0, -2, -1, 2, -3, -4, 2, 2, 1, -5, 2, -2, 6, 6, -4, 4, 0, 0, -2, 1, 4, 3, 0, 0, -6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
			want2:   &[]float64{-31019.799999999999, -2317.3000000000002, 5836.6000000000004, -855.20000000000005, 2962, -1281.5, 1426.2, 794.5, 1119.7, -1613.5, -450.10000000000002, 1204.0999999999999, 107.8, 851.60000000000002, 273.80000000000001, 889.60000000000002, 699.79999999999995, 218.80000000000001, 611.5, -142.69999999999999, -424.60000000000002, -146.09999999999999, 204.40000000000001, -60.899999999999999, -223.69999999999999, 326, -114.2, 233, 58, -24.5, -39.799999999999997, -120.8, -124.09999999999999, -64.099999999999994, 45.399999999999999, 61, 54.700000000000003, 0.89999999999999991, -9.6999999999999993, 96.900000000000006, -234.5, 11.9, -44.200000000000003, -20.800000000000001, 42.5, 16.5, -101.59999999999999, -55.5, 73, -54, -49.299999999999997, 2.2999999999999998, -14, 28.399999999999999, -13.300000000000001, -36.399999999999999, 4.2999999999999998, -15.4, 28.300000000000001, 19, -16.300000000000001, 6, -21.699999999999999, 11, 7, 8, -3, -15, -9, 6, 2, -14, 4, 5, -7, 17, 6.2999999999999998, -5, 8, -19, 8, 10, -20, 1, 14, -11, 5, 12, -3, 1, -2, -2, 9, 2, 10, 0, -2, -1, 2, -3, -4, 2, 2, 1, -5, 2, -2, 6, 6, -4, 4, 0, 0, -2, 1, 4, 3, 0, 0, -6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
			want3:   10,
			wantErr: false,
		},
		{
			name:    "1944.5: Coeffs when degrees are equal (10), and coeffs are between non-definitive and definitive",
			args:    args{date: 1944.5},
			want1:   &[]float64{-30600, -2285.6999999999998, 5811.1000000000004, -1230.2, 2989.0999999999999, -1693.2, 1576.8, 482.10000000000002, 1277.8, -1829.5999999999999, -499, 1252.7, 183.69999999999999, 913.29999999999995, -5.6000000000000014, 941, 774.60000000000002, 146.5, 544.60000000000002, -273.60000000000002, -419.39999999999998, -56.700000000000003, 300.10000000000002, -174.30000000000001, -251.80000000000001, 344.80000000000001, -14.099999999999998, 195.40000000000001, 92.599999999999994, -21.299999999999997, -67.799999999999997, -141.90000000000001, -118.40000000000001, -81.400000000000006, 80.700000000000003, 58.799999999999997, 56.700000000000003, 5.7999999999999998, 4.7000000000000011, 100.5, -246.30000000000001, 17.699999999999999, -24.300000000000001, -9.5999999999999996, 20.699999999999999, -14.4, -104.3, -38.399999999999999, 70.400000000000006, -41.299999999999997, -45.700000000000003, 0.39999999999999991, -18, 2, 0.40000000000000036, -29.199999999999999, 6.0999999999999996, -9.9000000000000004, 28.100000000000001, 15.199999999999999, -17.300000000000001, 26.600000000000001, -21.699999999999999, 12.800000000000001, 7, 11.6, -7.5, -20.300000000000001, -5.5, -10.300000000000001, 8.1999999999999993, -7.7999999999999998, 6.9000000000000004, 2.2999999999999998, -9.5, 18.100000000000001, 7.2000000000000002, 2.2000000000000002, 2.5, -11.800000000000001, 5.2999999999999998, -17.900000000000002, -26.399999999999999, 1, 16.800000000000001, -11.1, 26.600000000000001, 3.7999999999999998, -8.4000000000000004, 14.5, 3.2999999999999998, -2.8999999999999999, 9, -3.2999999999999998, 6.5, -2.6000000000000001, 0.70000000000000018, -3.7999999999999998, 7.4000000000000004, -3, 9.5, 4.7000000000000002, 1.1000000000000001, 1, 1.2999999999999998, -17.800000000000001, -4.7000000000000002, -0.29999999999999982, -0.29999999999999982, -5.7999999999999998, 7.5999999999999996, 5.4000000000000004, -0.90000000000000002, -3.7000000000000002, -2.5, -1.4000000000000004, 4.7999999999999998, 0, -1.8, -2.3999999999999999, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
			want2:   &[]float64{-30588, -2284.3000000000002, 5808.8999999999996, -1257.8, 2990.9000000000001, -1710.8, 1579.2, 471.89999999999998, 1286.2, -1838.4000000000001, -499, 1257.3, 188.30000000000001, 912.70000000000005, -16.400000000000006, 947, 777.39999999999998, 141.5, 543.39999999999998, -278.39999999999998, -422.60000000000002, -53.299999999999997, 307.89999999999998, -181.69999999999999, -254.19999999999999, 347.19999999999999, -9.8999999999999986, 192.59999999999999, 97.400000000000006, -18.699999999999999, -66.200000000000003, -142.09999999999999, -119.59999999999999, -82.599999999999994, 83.299999999999997, 59.200000000000003, 57.299999999999997, 6.2000000000000002, 7.3000000000000007, 99.5, -245.69999999999999, 14.299999999999997, -25.700000000000003, -8.3999999999999986, 21.300000000000001, -17.600000000000001, -103.7, -39.600000000000001, 69.599999999999994, -38.700000000000003, -44.299999999999997, -0.40000000000000036, -18, -2, 3.6000000000000014, -28.800000000000001, 5.9000000000000004, -10.1, 27.899999999999999, 14.800000000000001, -16.699999999999999, 31.400000000000002, -22.300000000000001, 13.199999999999999, 7, 12.4, -8.5, -21.700000000000003, -4.5, -13.700000000000003, 9.8000000000000007, -6.1999999999999993, 7.0999999999999996, 1.6999999999999997, -10.5, 17.899999999999999, 6.7999999999999998, 3.8000000000000007, 1.5, -10.199999999999999, 4.6999999999999993, -24.100000000000001, -27.600000000000001, 1, 17.199999999999999, -10.9, 31.400000000000002, 2.1999999999999993, -9.6000000000000014, 17.5, 4.7000000000000011, -3.1000000000000001, 9, -4.7000000000000011, 5.5, -3.4000000000000004, 1.3000000000000003, -4.2000000000000002, 8.6000000000000014, -3, 12.5, 5.3000000000000007, 0.89999999999999991, 1, 2.7000000000000011, -22.200000000000003, -5.3000000000000007, -1.7000000000000011, -1.7000000000000011, -6.2000000000000002, 8.4000000000000004, 6.6000000000000005, -1.1000000000000001, -4.3000000000000007, -3.5, -2.6000000000000005, 5.2000000000000002, 0, -2.2000000000000002, -1.5999999999999996, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
			want3:   10,
			wantErr: false,
		},
		{
			name:    "1955.5: Coeffs when degrees are equal (10), and coeffs are definitive - 1",
			args:    args{date: 1955.5},
			want1:   &[]float64{-30492.099999999999, -2210.4000000000001, 5817.1000000000004, -1451.5, 3002.9000000000001, -1904.9000000000001, 1581.9000000000001, 282.5, 1302, -1948.8, -457.19999999999999, 1288.0999999999999, 216.80000000000001, 881.60000000000002, -87.700000000000003, 957.89999999999998, 796.39999999999998, 133.19999999999999, 509.39999999999998, -274.39999999999998, -396.69999999999999, -20.399999999999999, 287.89999999999998, -232.5, -228.30000000000001, 360.19999999999999, 15.1, 231.19999999999999, 111.5, -23.300000000000001, -99.900000000000006, -152.40000000000001, -120.3, -68.400000000000006, 78.299999999999997, 46.899999999999999, 57.100000000000001, -9.0999999999999996, 2.7999999999999998, 96.299999999999997, -246, 49.200000000000003, -7.2999999999999998, -16.399999999999999, 6.0999999999999996, -11.9, -107.59999999999999, -23.300000000000001, 65.200000000000003, -56, -50.5, 2.2999999999999998, -24.399999999999999, 10.5, -4.2000000000000002, -32, 7.9000000000000004, -10.6, 27.5, 9.8000000000000007, -19.800000000000001, 17, -17.899999999999999, 11.4, 8.6999999999999993, 10.1, -5.7999999999999998, -14.9, -13.699999999999999, 5.2000000000000002, 5.5999999999999996, -22.5, 10, 3.1000000000000001, -6.7999999999999998, 23, 6.4000000000000004, -3.5, 8.9000000000000004, -13.699999999999999, 4, 8.6999999999999993, -11.699999999999999, -3.6000000000000001, 12, -5.4000000000000004, 6.5, 1.8999999999999999, 5.4000000000000004, 4, -2.1000000000000001, 0.80000000000000004, 9.9000000000000004, 1.6000000000000001, 7.0999999999999996, 2.1000000000000001, -5.4000000000000004, 4.4000000000000004, 5, -2.6000000000000001, -4.7999999999999998, -3.2000000000000002, -0.5, 0.10000000000000001, 1.8, -7.2000000000000002, -2.7999999999999998, -1.6000000000000001, 6.7000000000000002, -4.0999999999999996, 4.2000000000000002, 1, -1.7, -2.7999999999999998, 5.2999999999999998, 6.9000000000000004, -1.6000000000000001, -0.90000000000000002, 0, -3.3999999999999999, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
			want2:   &[]float64{-30476.299999999999, -2201.1999999999998, 5811.3000000000002, -1474.5, 3002.6999999999998, -1918.7, 1583.7, 265.5, 1302, -1958.4000000000001, -447.60000000000002, 1288.3, 218.40000000000001, 880.79999999999995, -97.099999999999994, 957.70000000000005, 797.20000000000005, 133.59999999999999, 508.19999999999999, -275.19999999999999, -396.10000000000002, -15.199999999999999, 283.69999999999999, -237.5, -226.90000000000001, 360.60000000000002, 15.300000000000001, 233.59999999999999, 114.5, -23.899999999999999, -103.7, -153.19999999999999, -118.90000000000001, -67.200000000000003, 78.900000000000006, 46.700000000000003, 57.299999999999997, -9.3000000000000007, 2.3999999999999999, 96.900000000000006, -244, 51.600000000000001, -5.9000000000000004, -17.199999999999999, 4.3000000000000007, -11.699999999999999, -108.8, -21.899999999999999, 65.599999999999994, -56, -51.5, 2.8999999999999999, -25.199999999999999, 11.5, -4.5999999999999996, -32, 7.7000000000000002, -9.8000000000000007, 26.5, 11.4, -19.399999999999999, 15, -17.699999999999999, 12.199999999999999, 8.0999999999999996, 10.300000000000001, -5.4000000000000004, -14.699999999999999, -13.1, 5.5999999999999996, 4.7999999999999998, -21.5, 10, 3.2999999999999998, -6.4000000000000004, 23, 7.2000000000000002, -2.5, 8.6999999999999993, -15.1, 4, 8.0999999999999996, -13.1, -2.7999999999999998, 12, -6.2000000000000002, 5.5, 1.7, 4.2000000000000002, 4, -2.2999999999999998, 0.40000000000000002, 9.6999999999999993, 0.80000000000000004, 7.2999999999999998, 2.2999999999999998, -4.2000000000000002, 3.2000000000000002, 5, -1.8, -4.4000000000000004, -1.6000000000000001, 0.5, 0.29999999999999999, 1.3999999999999999, -5.5999999999999996, -2.3999999999999999, -0.80000000000000004, 6.0999999999999996, -4.2999999999999998, 4.5999999999999996, 1, -1.1000000000000001, -2.3999999999999999, 3.8999999999999999, 6.7000000000000002, -0.80000000000000004, -0.69999999999999996, 0, -4.2000000000000002, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
			want3:   10,
			wantErr: false,
		},
		{
			name:    "2017.5: Coeffs when degrees are equal (13), and coeffs are definitive - 2",
			args:    args{date: 2017.5},
			want1:   &[]float64{-29422.435, -1476.57, 4724.67, -2472.83, 2997.08, -2918.565, 1676.6, -688.395, 1356.665, -2366.53, -98.625, 1230.955, 243.42, 553.645, -540.61, 905.12, 811.575, 282.82, 103.335, -173.465, -322.16, 190.35, 58.91, -339.765, -233.665, 361.7, 47.25, 190.105, 202.67, -140.835, -120.285, -154.28, 24.035, 9.14, 99.63, 67.76, 66.565, -19.915, 72.875, 29.16, -125.71, 55.75, -32.495, -65.52, 13.37, 8.155, -67.825, 65.225, 80.915, -76.31, -52.885, -7.51, -18.19, 54.135, 3.975, 15.435, 24.005, 7.81, 0.54, -5.045, -27.345, 8.19, -2.11, 23.82, 9.315, 9.235, -17.135, -16.745, -1.825, 13.005, -20.815, -13.18, 14.305, 15.55, 12.705, 4.655, -16.285, -8, -1.18, 2.58, 5.18, 8.595, -22.605, 2.93, 10.9, -2.35, 10.8, -0.235, -5.935, -13.21, -6.54, 0.49, 7.79, 8.75, 0.72, -9.145, -2.665, -11.2, 9.02, -1.925, -6.255, 3.33, 0.03, -0.29, 1.105, 4.025, -0.705, 4.63, 1.175, -8.27, -0.775, -0.36, 2.005, -4.21, 1.885, -3.14, -2.09, -0.61, -3.715, -8.78, 2.98, -1.38, -0.01, -2.405, 2.305, 2.195, -0.575, -0.82, -0.72, 0.43, 0.69, -0.68, -0.205, 0.035, -1.89, 1.57, -1.52, -0.405, -2.775, 0.31, -1.99, 3.29, -2.425, -2.045, -0.145, -1.115, 0.445, 0.445, 1.255, 1.56, -1.015, -2, 0.78, 0.175, 0.205, 0.715, 0.515, -0.12, -0.315, 0.42, -0.45, 0.195, 0.155, -0.91, -1.035, -0.1, -0.18, 0.62, 0.03, -0.925, -0.88, 0.475, 0.565, 0.675, 1.48, -0.36, -0.44, 0.855, -1.275, -0.1, -0.095, 0.785, 0.355, -0.09, -0.075, 0.375, 0.475, 0.105, 0.51, 0.455, -0.355, -0.405, -0.395, -0.38, -0.655},
			want2:   &[]float64{-29414.825, -1466.49, 4696.142, -2483.61, 2991.032, -2947.827, 1676.7, -706.885, 1359.199, -2372.238, -91.959, 1232.997, 242.772, 542.427, -541.374, 904.2, 810.733, 282.532, 96.473, -167.479, -317.084, 194.11, 54.322, -343.979, -233.967, 362.324, 47.358, 189.207, 204.946, -140.793, -120.743, -153.032, 27.257, 11.076, 99.434, 67.044, 66.163, -19.637, 72.909, 27.504, -124.054, 54.554, -33.921, -65.072, 13.462, 8.477, -66.615, 66.351, 80.765, -76.438, -52.331, -7.798, -17.654, 55.061, 3.329, 15.581, 23.827, 7.206, -0.552, -5.911, -27.283, 8.822, -2.026, 23.756, 9.485, 8.913, -17.277, -16.139, -1.291, 12.935, -20.917, -12.612, 14.695, 15.306, 13.083, 4.241, -16.407, -7.56, -0.844, 2.708, 5.12, 8.501, -22.939, 2.894, 10.956, -2.002, 10.424, -0.597, -5.613, -13.214, -6.404, 0.726, 7.79, 8.778, 0.592, -9.179, -2.175, -11.464, 9.252, -1.891, -6.253, 3.35, -0.026, -0.246, 1.327, 3.815, -0.767, 4.722, 0.965, -8.41, -0.817, -0.26, 1.955, -4.23, 1.707, -3.256, -2.206, -0.406, -3.765, -8.804, 2.972, -1.372, -0.014, -2.447, 2.383, 2.241, -0.565, -0.832, -0.588, 0.37, 0.662, -0.672, -0.207, -0.007, -1.798, 1.518, -1.552, -0.479, -2.857, 0.258, -1.982, 3.21, -2.459, -2.027, -0.139, -1.129, 0.439, 0.475, 1.265, 1.484, -1.065, -1.924, 0.752, 0.137, 0.247, 0.713, 0.505, -0.132, -0.293, 0.472, -0.458, 0.181, 0.129, -0.918, -1.073, -0.076, -0.24, 0.58, 0.05, -0.927, -0.88, 0.497, 0.595, 0.693, 1.448, -0.336, -0.416, 0.813, -1.289, -0.064, -0.093, 0.775, 0.329, -0.074, -0.089, 0.373, 0.473, 0.115, 0.522, 0.453, -0.377, -0.427, -0.381, -0.388, -0.633},
			want3:   13,
			wantErr: false,
		},
		{
			name:    "1999.5: Coeffs when degrees are not equal (10 > 13)",
			args:    args{date: 1999.5},
			want1:   &[]float64{-29626.66, -1733.78, 5198.0900000000001, -2260.9299999999998, 3068.5599999999999, -2470.04, 1671.9100000000001, -453.5, 1339.1399999999999, -2285.9000000000001, -231.03999999999999, 1251.79, 294.25999999999999, 718.95000000000005, -484.69, 933.06999999999994, 786.12, 271.54000000000002, 254, -232.31, -404.5, 117.52, 112.37, -304.01999999999998, -218.32000000000002, 351.45999999999998, 44.019999999999996, 223.57000000000002, 171.21000000000001, -129.16, -134.09, -168.34, -40.869999999999997, -13.31, 106.37, 71.870000000000005, 68.079999999999998, -17.359999999999999, 73.579999999999998, 64.530000000000001, -161.81, 65.289999999999992, -5.4100000000000001, -60.880000000000003, 17.109999999999999, 0.72999999999999998, -90.660000000000011, 43.019999999999996, 78.799999999999997, -73.799999999999997, -65.039999999999992, 0.099999999999999978, -24.280000000000001, 32.769999999999996, 5.9800000000000004, 8.6899999999999995, 24, 6.6100000000000003, 15.020000000000001, 7.3700000000000001, -25.259999999999998, -1.2799999999999998, -5.8200000000000003, 24.459999999999997, 6.54, 11.81, -8.879999999999999, -21.449999999999999, -8.0099999999999998, 8.4499999999999993, -16.34, -21.649999999999999, 9.0899999999999999, 15.449999999999999, 6.9000000000000004, 9.1099999999999994, -7.6100000000000003, -15.01, -7, -2.29, 4.9000000000000004, 9.3599999999999994, -19.73, 3, 13.56, -8.5600000000000005, 12.449999999999999, 6.4699999999999998, -6.1799999999999997, -8.8100000000000005, -8.3599999999999994, -1.45, 8.3599999999999994, 9.370000000000001, 3.9199999999999999, -4.0700000000000003, -8.1799999999999997, -8.1799999999999997, 4.6200000000000001, -2.6400000000000001, -6, 1.6299999999999999, 1.73, 0, -3.1899999999999999, 4, -0.55000000000000004, 4.9100000000000001, 3.73, -5.8100000000000005, 1.1000000000000001, -1.1799999999999999, 2, -2.8100000000000001, 4.2800000000000002, 0.27999999999999992, 0.37, -2.1800000000000002, -0.9900000000000001, -7.3600000000000003, 2.4300000000000002, -1.53, 0.090000000000000011, -1.71, 1.1700000000000002, 1.3500000000000001, -0.81000000000000005, -0.090000000000000011, -2.3400000000000003, 0.090000000000000011, 0.81000000000000005, -0.63, -0.63, 0.63, -2.52, 1.53, -0.81000000000000005, 0.090000000000000011, -1.0800000000000001, 1.0800000000000001, -1.71, 3.6000000000000001, -0.81000000000000005, -1.9800000000000002, -0.27000000000000002, -0.36000000000000004, 0.18000000000000002, 0.27000000000000002, 0.81000000000000005, 2.25, -0.18000000000000002, -2.3400000000000003, 0.81000000000000005, 0.63, -0.45000000000000001, 0.27000000000000002, 0.27000000000000002, 0, -0.27000000000000002, 0, -0.36000000000000004, 0.27000000000000002, -0.090000000000000011, -0.81000000000000005, -0.18000000000000002, -0.36000000000000004, -0.36000000000000004, 0.72000000000000008, -0.18000000000000002, -0.81000000000000005, -0.81000000000000005, 0.27000000000000002, 0.18000000000000002, 0.090000000000000011, 1.6200000000000001, -0.36000000000000004, -0.36000000000000004, 1.1700000000000002, -0.90000000000000002, -0.36000000000000004, -0.090000000000000011, 0.63, 0.63, -0.36000000000000004, 0.27000000000000002, 0.27000000000000002, 0.54000000000000004, -0.090000000000000011, 0.27000000000000002, 0.36000000000000004, -0.18000000000000002, 0, -0.45000000000000001, 0.090000000000000011, -0.81000000000000005},
			want2:   &[]float64{-29612.140000000003, -1722.6200000000001, 5174.1100000000006, -2274.4699999999998, 3068.2400000000002, -2493.1599999999999, 1669.8900000000001, -462.5, 1340.0599999999999, -2290.0999999999999, -224.16, 1252.4099999999999, 292.53999999999996, 710.04999999999995, -497.51000000000005, 931.52999999999997, 787.4799999999999, 273.66000000000003, 246, -231.49000000000001, -401.5, 122.08, 110.22999999999999, -303.58000000000004, -219.28, 351.33999999999997, 43.579999999999998, 221.03, 172.59, -131.64000000000001, -132.10999999999999, -168.85999999999999, -37.729999999999997, -12.49, 106.22999999999999, 72.72999999999999, 68.320000000000007, -17.439999999999998, 74.820000000000007, 62.870000000000005, -159.99000000000001, 64.909999999999997, -6.3900000000000006, -61.520000000000003, 16.689999999999998, 0.66999999999999993, -90.140000000000001, 44.579999999999998, 79.200000000000003, -74.200000000000003, -64.159999999999997, -0.10000000000000009, -24.119999999999997, 33.829999999999998, 6.4199999999999999, 9.5099999999999998, 24, 7.1900000000000013, 14.58, 7.2299999999999995, -25.539999999999999, -1.1199999999999999, -5.7799999999999994, 24.34, 6.6600000000000001, 11.99, -9.5199999999999996, -21.550000000000001, -7.79, 8.5500000000000007, -16.860000000000003, -21.350000000000001, 9.1099999999999994, 15.550000000000001, 7.0999999999999996, 8.6900000000000013, -8.1900000000000013, -14.790000000000001, -7, -1.9100000000000001, 5.0999999999999996, 9.4400000000000013, -19.669999999999998, 3, 13.24, -8.2400000000000002, 12.550000000000001, 6.1299999999999999, -6.2200000000000006, -8.9900000000000002, -8.4400000000000013, -1.55, 8.4400000000000013, 9.2300000000000004, 3.6799999999999997, -4.5299999999999994, -8.2199999999999989, -8.2199999999999989, 4.9800000000000004, -2.5600000000000001, -6, 1.77, 1.6699999999999999, 0, -3.0099999999999998, 4, -0.44999999999999996, 4.8900000000000006, 3.6699999999999999, -5.9900000000000002, 0.89999999999999991, -1.22, 2, -2.9900000000000002, 4.1200000000000001, 0.11999999999999988, 0.22999999999999998, -2.2200000000000002, -1.2100000000000002, -7.4400000000000004, 2.9700000000000006, -1.8700000000000001, 0.11000000000000001, -2.0899999999999999, 1.4300000000000002, 1.6500000000000001, -0.9900000000000001, -0.11000000000000001, -2.8600000000000003, 0.11000000000000001, 0.9900000000000001, -0.77000000000000002, -0.77000000000000002, 0.77000000000000002, -3.0800000000000001, 1.8700000000000001, -0.9900000000000001, 0.11000000000000001, -1.3200000000000001, 1.3200000000000001, -2.0899999999999999, 4.4000000000000004, -0.9900000000000001, -2.4200000000000004, -0.33000000000000002, -0.44000000000000006, 0.22000000000000003, 0.33000000000000002, 0.9900000000000001, 2.75, -0.22000000000000003, -2.8600000000000003, 0.9900000000000001, 0.77000000000000002, -0.55000000000000004, 0.33000000000000002, 0.33000000000000002, 0, -0.33000000000000002, 0, -0.44000000000000006, 0.33000000000000002, -0.11000000000000001, -0.9900000000000001, -0.22000000000000003, -0.44000000000000006, -0.44000000000000006, 0.88000000000000012, -0.22000000000000003, -0.9900000000000001, -0.9900000000000001, 0.33000000000000002, 0.22000000000000003, 0.11000000000000001, 1.9800000000000002, -0.44000000000000006, -0.44000000000000006, 1.4300000000000002, -1.1000000000000001, -0.44000000000000006, -0.11000000000000001, 0.77000000000000002, 0.77000000000000002, -0.44000000000000006, 0.33000000000000002, 0.33000000000000002, 0.66000000000000003, -0.11000000000000001, 0.33000000000000002, 0.44000000000000006, -0.22000000000000003, 0, -0.55000000000000004, 0.11000000000000001, -0.9900000000000001},
			want3:   13,
			wantErr: false,
		},
		{
			name:    "2022.5: Coeffs when degrees are equal (13), and coeffs are definitive - 3",
			args:    args{date: 2022.5},
			want1:   &[]float64{-29376.705, -1430.835, 4599.425, -2527.99, 2966.43, -3062.66, 1662.775, -774.41, 1361.95, -2392.5, -69.43, 1239.93, 239.7, 489.5, -546.06, 898.76, 804.535, 280.35, 70.99, -146.25, -295.285, 205.875, 29.72, -362.85, -233.66, 366.13, 46.41, 187.53, 214.18, -139.715, -122.165, -146.53, 37.495, 17.44, 102.67, 65.135, 64.68, -18.81, 74.83, 20.91, -118.635, 50.83, -38.48, -62.1, 14.25, 9.93, -62.8, 70.42, 80.07, -76.765, -50.2, -8.515, -15.625, 57.875, 0.68, 15.8, 23.53, 4.4, -4.795, -9.205, -26.145, 12.035, -2.05, 23.38, 10.32, 7.815, -17.495, -13.915, 0.755, 12.165, -21.435, -10.73, 16.09, 13.82, 14.275, 2.16, -16.695, -6.05, 0.33, 3.4, 4.865, 8.18, -24.12, 2.92, 11.57, -0.84, 9.08, -1.82, -4.265, -13.16, -5.75, 1.74, 7.495, 8.71, -0.1, -8.965, -0.32, -12.33, 9.7, -1.57, -6.325, 3.34, 0.045, -0.04, 1.83, 3, -0.93, 5.13, 0.075, -8.81, -0.89, 0.145, 1.69, -4.23, 1.17, -3.615, -2.49, 0.4, -3.87, -8.92, 2.98, -1.38, -0.01, -2.505, 2.65, 2.355, -0.575, -0.725, -0.145, 0.14, 0.56, -0.63, -0.255, -0.085, -1.43, 1.27, -1.65, -0.795, -2.94, 0.04, -1.885, 2.845, -2.405, -2, -0.115, -1.175, 0.415, 0.56, 1.24, 1.185, -1.17, -1.655, 0.655, 0.04, 0.405, 0.655, 0.495, -0.175, -0.18, 0.675, -0.485, 0.13, -0.055, -0.915, -1.165, 0.03, -0.515, 0.36, 0.14, -0.915, -0.89, 0.565, 0.67, 0.71, 1.3, -0.25, -0.34, 0.625, -1.305, 0.045, -0.095, 0.73, 0.245, -0.025, -0.155, 0.335, 0.485, 0.165, 0.57, 0.425, -0.505, -0.48, -0.33, -0.4, -0.55},
			want2:   &[]float64{-29366.023, -1422.621, 4577.855, -2539.274, 2960.218, -3091.036, 1657.145, -790.326, 1361.53, -2397.18, -64.418, 1241.478, 238.86, 475.06, -547.476, 897.136, 802.561, 279.65, 64.914, -141.35, -289.611, 208.325, 22.632, -367.87, -233.356, 367.278, 45.966, 187.398, 216.508, -139.309, -122.459, -144.678, 39.657, 18.824, 104.082, 64.801, 64.328, -18.646, 75.578, 19.266, -117.461, 50.058, -39.448, -61.18, 14.51, 10.318, -62, 71.372, 79.882, -76.819, -49.68, -8.629, -15.135, 58.445, 0.00800000000000001, 15.8, 23.518, 3.64, -5.837, -10.003, -25.727, 12.941, -2.11, 23.268, 10.552, 7.569, -17.497, -13.389, 1.253, 11.899, -21.581, -10.318, 16.414, 13.372, 14.525, 1.576, -16.737, -5.71, 0.598, 3.6, 4.799, 8.108, -24.392, 2.952, 11.782, -0.584, 8.768, -2.092, -3.919, -13.136, -5.57, 2.004, 7.377, 8.666, -0.3, -8.859, 0.128, -12.518, 9.74, -1.462, -6.355, 3.324, 0.107, 0.016, 1.898, 2.8, -0.958, 5.238, -0.155, -8.886, -0.894, 0.247, 1.614, -4.218, 1.062, -3.689, -2.534, 0.6, -3.882, -8.952, 2.988, -1.388, -0.006, -2.503, 2.71, 2.373, -0.585, -0.675, -0.047, 0.084, 0.536, -0.618, -0.273, -0.091, -1.338, 1.202, -1.67, -0.877, -2.924, -0.016, -1.851, 2.747, -2.363, -2, -0.109, -1.185, 0.409, 0.576, 1.224, 1.111, -1.182, -1.593, 0.633, 0.024, 0.443, 0.633, 0.497, -0.185, -0.148, 0.725, -0.491, 0.118, -0.113, -0.909, -1.179, 0.058, -0.589, 0.296, 0.164, -0.909, -0.894, 0.579, 0.682, 0.706, 1.26, -0.23, -0.324, 0.575, -1.303, 0.067, -0.097, 0.718, 0.227, -0.015, -0.173, 0.321, 0.491, 0.179, 0.582, 0.415, -0.543, -0.488, -0.318, -0.4, -0.53},
			want3:   13,
			wantErr: false,
		},
		{
			name:    "2029.5: Coeffs for the date just before the end of the last epoch.",
			args:    args{date: 2029.5},
			want1:   &[]float64{-29293.3, -1365.3, 4448.75, -2606.6, 2927.05, -3256.45, 1611.35, -864.15, 1354.15, -2424, -39.8, 1245.6, 236.7, 383.2, -567.15, 887.05, 789.25, 272.75, 29.7, -115.55, -256.8, 219.2, -18.6, -393.85, -230.2, 374.85, 43.05, 187.2, 229.45, -135.55, -120.65, -131.55, 50.55, 25.4, 114.75, 63.4, 62.45, -17.05, 80.3, 9.6, -110.3, 47.1, -44.5, -56.2, 16.7, 14.05, -56.75, 76.85, 79.15, -77.35, -46.2, -9.25, -12.15, 61.55, -4.15, 15.35, 23.5, -1.1, -11.45, -14.8, -22.85, 18.35, -3.55, 22.65, 11.8, 5.85, -17.5, -10.8, 3.8, 10.15, -22.25, -7.9, 18.25, 10.45, 15.35, -2, -16.8, -3.85, 2.35, 4.8, 4.7, 8, -24.8, 3, 12.1, -0.2, 8.3, -2.5, -3.4, -13.1, -5.3, 2.4, 7.2, 8.6, -0.6, -8.7, 0.8, -12.8, 9.8, -1.3, -6.4, 3.3, 0.2, 0.1, 2, 2.5, -1, 5.4, -0.5, -9, -0.9, 0.4, 1.5, -4.2, 0.9, -3.8, -2.6, 0.9, -3.9, -9, 3, -1.4, 0, -2.5, 2.8, 2.4, -0.6, -0.6, 0.1, 0, 0.5, -0.6, -0.3, -0.1, -1.2, 1.1, -1.7, -1, -2.9, -0.1, -1.8, 2.6, -2.3, -2, -0.1, -1.2, 0.4, 0.6, 1.2, 1, -1.2, -1.5, 0.6, 0, 0.5, 0.6, 0.5, -0.2, -0.1, 0.8, -0.5, 0.1, -0.2, -0.9, -1.2, 0.1, -0.7, 0.2, 0.2, -0.9, -0.9, 0.6, 0.7, 0.7, 1.2, -0.2, -0.3, 0.5, -1.3, 0.1, -0.1, 0.7, 0.2, 0, -0.2, 0.3, 0.5, 0.2, 0.6, 0.4, -0.6, -0.5, -0.3, -0.4, -0.5},
			want2:   &[]float64{-29280.7, -1355.3, 4427.25, -2617.8, 2921.75, -3283.75, 1603.05, -875.25, 1352.65, -2428.4, -36, 1246, 236.5, 367.6, -571.05, 885.35, 786.95, 271.45, 23.9, -111.45, -251.4, 220.8, -25.4, -397.95, -229.6, 376.15, 42.55, 187.2, 231.55, -134.85, -120.15, -129.25, 52.25, 26.4, 116.65, 63.2, 62.15, -16.75, 81.1, 8, -109.1, 46.7, -45.3, -55.4, 17.1, 14.75, -55.85, 77.75, 79.05, -77.45, -45.6, -9.35, -11.65, 62.05, -4.85, 15.25, 23.5, -1.9, -12.35, -15.6, -22.35, 19.25, -3.85, 22.55, 12, 5.55, -17.5, -10.4, 4.2, 9.85, -22.35, -7.5, 18.55, 9.95, 15.45, -2.6, -16.8, -3.55, 2.65, 5, 4.7, 8, -24.8, 3, 12.1, -0.2, 8.3, -2.5, -3.4, -13.1, -5.3, 2.4, 7.2, 8.6, -0.6, -8.7, 0.8, -12.8, 9.8, -1.3, -6.4, 3.3, 0.2, 0.1, 2, 2.5, -1, 5.4, -0.5, -9, -0.9, 0.4, 1.5, -4.2, 0.9, -3.8, -2.6, 0.9, -3.9, -9, 3, -1.4, 0, -2.5, 2.8, 2.4, -0.6, -0.6, 0.1, 0, 0.5, -0.6, -0.3, -0.1, -1.2, 1.1, -1.7, -1, -2.9, -0.1, -1.8, 2.6, -2.3, -2, -0.1, -1.2, 0.4, 0.6, 1.2, 1, -1.2, -1.5, 0.6, 0, 0.5, 0.6, 0.5, -0.2, -0.1, 0.8, -0.5, 0.1, -0.2, -0.9, -1.2, 0.1, -0.7, 0.2, 0.2, -0.9, -0.9, 0.6, 0.7, 0.7, 1.2, -0.2, -0.3, 0.5, -1.3, 0.1, -0.1, 0.7, 0.2, 0, -0.2, 0.3, 0.5, 0.2, 0.6, 0.4, -0.6, -0.5, -0.3, -0.4, -0.5},
			want3:   13,
			wantErr: false,
		},
		{
			name:    "2025.0: Coeffs for the date which is taken directly from coeffs.",
			args:    args{date: 2025.0},
			want1:   &[]float64{-29350, -1410.3, 4545.5, -2556.2, 2950.9, -3133.6, 1648.7, -814.2, 1360.9, -2404.2, -56.9, 1243.8, 237.6, 453.4, -549.6, 894.7, 799.6, 278.6, 55.8, -134, -281.1, 212, 12, -375.4, -232.9, 369, 45.3, 187.2, 220, -138.7, -122.9, -141.9, 42.9, 20.9, 106.2, 64.3, 63.8, -18.4, 76.7, 16.8, -115.7, 48.9, -40.9, -59.8, 14.9, 10.9, -60.8, 72.8, 79.6, -76.9, -48.9, -8.8, -14.4, 59.3, -1, 15.8, 23.5, 2.5, -7.4, -11.2, -25.1, 14.3, -2.2, 23.1, 10.9, 7.2, -17.5, -12.6, 2, 11.5, -21.8, -9.7, 16.9, 12.7, 14.9, 0.7, -16.8, -5.2, 1, 3.9, 4.7, 8, -24.8, 3, 12.1, -0.2, 8.3, -2.5, -3.4, -13.1, -5.3, 2.4, 7.2, 8.6, -0.6, -8.7, 0.8, -12.8, 9.8, -1.3, -6.4, 3.3, 0.2, 0.1, 2, 2.5, -1, 5.4, -0.5, -9, -0.9, 0.4, 1.5, -4.2, 0.9, -3.8, -2.6, 0.9, -3.9, -9, 3, -1.4, 0, -2.5, 2.8, 2.4, -0.6, -0.6, 0.1, 0, 0.5, -0.6, -0.3, -0.1, -1.2, 1.1, -1.7, -1, -2.9, -0.1, -1.8, 2.6, -2.3, -2, -0.1, -1.2, 0.4, 0.6, 1.2, 1, -1.2, -1.5, 0.6, 0, 0.5, 0.6, 0.5, -0.2, -0.1, 0.8, -0.5, 0.1, -0.2, -0.9, -1.2, 0.1, -0.7, 0.2, 0.2, -0.9, -0.9, 0.6, 0.7, 0.7, 1.2, -0.2, -0.3, 0.5, -1.3, 0.1, -0.1, 0.7, 0.2, 0, -0.2, 0.3, 0.5, 0.2, 0.6, 0.4, -0.6, -0.5, -0.3, -0.4, -0.5},
			want2:   &[]float64{-29337.4, -1400.3, 4524, -2567.4, 2945.6, -3160.9, 1640.4, -825.3, 1359.4, -2408.6, -53.1, 1244.2, 237.4, 437.8, -553.5, 893, 797.3, 277.3, 50, -129.9, -275.7, 213.6, 5.2, -379.5, -232.3, 370.3, 44.8, 187.2, 222.1, -138, -122.4, -139.6, 44.6, 21.9, 108.1, 64.1, 63.5, -18.1, 77.5, 15.2, -114.5, 48.5, -41.7, -59, 15.3, 11.6, -59.9, 73.7, 79.5, -77, -48.3, -8.9, -13.9, 59.8, -1.7, 15.7, 23.5, 1.7, -8.3, -12, -24.6, 15.2, -2.5, 23, 11.1, 6.9, -17.5, -12.2, 2.4, 11.2, -21.9, -9.3, 17.2, 12.2, 15, 0.1, -16.8, -4.9, 1.3, 4.1, 4.7, 8, -24.8, 3, 12.1, -0.2, 8.3, -2.5, -3.4, -13.1, -5.3, 2.4, 7.2, 8.6, -0.6, -8.7, 0.8, -12.8, 9.8, -1.3, -6.4, 3.3, 0.2, 0.1, 2, 2.5, -1, 5.4, -0.5, -9, -0.9, 0.4, 1.5, -4.2, 0.9, -3.8, -2.6, 0.9, -3.9, -9, 3, -1.4, 0, -2.5, 2.8, 2.4, -0.6, -0.6, 0.1, 0, 0.5, -0.6, -0.3, -0.1, -1.2, 1.1, -1.7, -1, -2.9, -0.1, -1.8, 2.6, -2.3, -2, -0.1, -1.2, 0.4, 0.6, 1.2, 1, -1.2, -1.5, 0.6, 0, 0.5, 0.6, 0.5, -0.2, -0.1, 0.8, -0.5, 0.1, -0.2, -0.9, -1.2, 0.1, -0.7, 0.2, 0.2, -0.9, -0.9, 0.6, 0.7, 0.7, 1.2, -0.2, -0.3, 0.5, -1.3, 0.1, -0.1, 0.7, 0.2, 0, -0.2, 0.3, 0.5, 0.2, 0.6, 0.4, -0.6, -0.5, -0.3, -0.4, -0.5},
			want3:   13,
			wantErr: false,
		},
		{
			name:    "1024.5: Date below the starting epoch..",
			args:    args{date: 1024.5},
			want1:   nil,
			want2:   nil,
			want3:   0,
			wantErr: true,
		},
		{
			name:    "3024.5: Date beyond the ending epoch..",
			args:    args{date: 3024.5},
			want1:   nil,
			want2:   nil,
			want3:   0,
			wantErr: true,
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			got1, got2, got3, err := igrf.Coeffs(tt.args.date)
			if (err != nil) != tt.wantErr {
				t.Errorf("IGRFcoeffs.Coeffs() error = %v, wantErr %v", err, tt.wantErr)
				return
			}
			if tt.want3 != got3 {
				t.Errorf("IGRFcoeffs.Coeffs() nmax got %v, wanted %v", got3, tt.want3)
				return
			}
			if err != nil {
				return
			}
			for index, value1 := range *got1 {
				value2 := (*got2)[index]
				ref_value1 := math.Abs((*tt.want1)[index])
				ref_value2 := math.Abs((*tt.want2)[index])
				calc_err1 := math.Abs(100 * ((ref_value1 - math.Abs(value1)) / ref_value1))
				calc_err2 := math.Abs(100 * ((ref_value2 - math.Abs(value2)) / ref_value2))
				// allowable error percent
				max_error := 0.7
				if calc_err1 > max_error {
					t.Errorf("IGRFcoeffs.Coeffs() calculated value (start) = %v, reference %v, error %v is more than %v%%", value1, ref_value1, calc_err1, max_error)
				}
				if calc_err2 > max_error {
					t.Errorf("IGRFcoeffs.Coeffs() calculated value (end) = %v, reference %v, error %v is more than %v%%", value2, ref_value2, calc_err2, max_error)
				}
			}
		})
	}
}
